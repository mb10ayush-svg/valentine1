<!-- REQUIRED for screenshot -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  // ===== CUSTOMIZE HERE =====
  const HER_NAME = "Aishwarya";
  const CORRECT_PASSWORD = "251225";

  // Set glowing name
  const nameEl = document.getElementById("name");
  if (nameEl) nameEl.innerText = HER_NAME;

  // Unlock
  window.unlock = function () {
    if (document.getElementById("password").value === CORRECT_PASSWORD) {
      document.getElementById("lock").style.display = "none";
      document.getElementById("main").style.display = "block";
      const music = document.getElementById("music");
      if (music) music.play();
    } else {
      alert("Wrong password üòú");
    }
  };

  // Slideshow
  const slide = document.getElementById("slide");
  const photos = ["photo1.jpg", "photo2.jpg", "photo3.jpg"];
  let i = 0;
  if (slide) {
    setInterval(() => {
      i = (i + 1) % photos.length;
      slide.src = photos[i];
    }, 2500);
  }

  // YES button
  const yesBtn = document.getElementById("yesBtn");
  if (yesBtn) {
    yesBtn.onclick = () => {
      startConfetti();
      document.getElementById("main").innerHTML = `
        <div id="memory">
          <h1 class="glow">${HER_NAME} üíñ</h1>
          <div id="typing"></div>
          <p>
            This is my little secret for you.<br><br>
            You make my heart smile in ways I never expected.<br>
            I want to remember this moment forever ‚ù§Ô∏è
          </p>
          <button class="pink" onclick="saveMemory()">Save This Moment üì∏</button>
        </div>
      `;
      typeLove();
    };
  }

  // Typing animation
  const text = "I love you ‚ù§Ô∏è";
  function typeLove() {
    const el = document.getElementById("typing");
    if (!el) return;
    el.innerHTML = "";
    let t = 0;
    const timer = setInterval(() => {
      el.innerHTML += text.charAt(t++);
      if (t === text.length) {
        clearInterval(timer);
        setTimeout(typeLove, 1800);
      }
    }, 120);
  }

  // Screenshot
  window.saveMemory = function () {
    const memory = document.getElementById("memory");
    if (!memory) return;
    html2canvas(memory).then(canvas => {
      const link = document.createElement("a");
      link.download = "Aishwarya_Valentine_Memory.png";
      link.href = canvas.toDataURL();
      link.click();
    });
  };

  // NO button escape
  const noBtn = document.getElementById("noBtn");
  if (noBtn) {
    noBtn.onmouseover = () => {
      noBtn.style.left = Math.random() * 80 + "vw";
      noBtn.style.top = Math.random() * 80 + "vh";
    };
  }

  // Floating hearts
  setInterval(() => {
    const h = document.createElement("div");
    h.className = "heart";
    h.innerHTML = "‚ù§Ô∏è";
    h.style.left = Math.random() * 100 + "vw";
    document.body.appendChild(h);
    setTimeout(() => h.remove(), 5000);
  }, 400);

  // Confetti
  const canvas = document.getElementById("confetti");
  if (!canvas) return;
  const ctx = canvas.getContext("2d");
  canvas.width = innerWidth;
  canvas.height = innerHeight;
  let confetti = [];

  function startConfetti() {
    for (let i = 0; i < 160; i++) {
      confetti.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height - canvas.height,
        r: Math.random() * 6 + 4,
        color: `hsl(${Math.random() * 360},100%,70%)`
      });
    }
    requestAnimationFrame(drawConfetti);
  }

  function drawConfetti() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    confetti.forEach((c, i) => {
      ctx.beginPath();
      ctx.fillStyle = c.color;
      ctx.arc(c.x, c.y, c.r, 0, Math.PI * 2);
      ctx.fill();
      c.y += 4;
      if (c.y > canvas.height) confetti.splice(i, 1);
    });
    if (confetti.length) requestAnimationFrame(drawConfetti);
  }

});
</script>
